for the future:
- implement a series of checks to make sure the user has written something sensible
- spectral model needs to be allowed to vary from pixel to pixel (Gaussian process)
- compare output label to the training space, flag if extrapolation has taken place
- create non-identical subsets of the training set
- shot noise in the creation of a training set
- check the scatter at each pixel

I don't understand:
- MCM_rotate_all matrix...what is it? it's the coefficients multiplied by the inverse covariance (1/errors^2). Just has to be the right shape for matrix multiplication to work. MKN will send me the maths in the next couple of days. 
